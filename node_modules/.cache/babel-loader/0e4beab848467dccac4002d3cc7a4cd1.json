{"ast":null,"code":"var _this = this;\n\nimport * as THREE from 'three';\nimport alphaTexture from '../../../assets/textures/stripes_gradient.jpg';\nimport * as OBJLoader from \"three-obj-loader\";\nimport model from \"../../../assets/models/dummy.obj\";\nOBJLoader(THREE);\nthis.THREE = THREE;\nthis.loader = new this.THREE.OBJLoader();\n\nthis.loadGeo = function () {\n  _this.loader.load( // resource URL\n  model, // called when resource is loaded\n  function (object) {\n    console.log(object);\n\n    _this.setState({\n      resource: object\n    });\n  }, // called when loading is in progresses\n  function (xhr) {\n    console.log(xhr.loaded / xhr.total * 100 + \"% loaded\");\n  }, // called when loading has errors\n  function (error) {\n    console.log(\"An error happened\");\n  });\n};\n\nexport default (function (scene, geo, model) {\n  var group = new THREE.Group(); // const subjectGeometry = deformGeometry(geo);\n\n  var subjectGeometry = geo;\n  var subjectMaterial = new THREE.MeshStandardMaterial({\n    color: \"#000\",\n    transparent: true,\n    side: THREE.DoubleSide,\n    alphaTest: 0.5\n  });\n  subjectMaterial.alphaMap = new THREE.TextureLoader().load(alphaTexture);\n  subjectMaterial.alphaMap.magFilter = THREE.NearestFilter;\n  subjectMaterial.alphaMap.wrapT = THREE.RepeatWrapping;\n  subjectMaterial.alphaMap.repeat.y = 1;\n  var subjectMesh = new THREE.Mesh(subjectGeometry, subjectMaterial);\n  var subjectWireframe = new THREE.LineSegments(new THREE.EdgesGeometry(subjectGeometry), new THREE.LineBasicMaterial()); //upload a model\n\n  group.add(subjectMesh);\n  group.add(subjectWireframe);\n  scene.add(group);\n  group.rotation.z = 6 * Math.PI;\n  var speed = 0.02;\n  var textureOffsetSpeed = 0.02; // function deformGeometry(geometry) {\n  //     for (let i=0; i<geometry.vertices.length; i+=2) {\n  //         const scalar = 1 + Math.random()*0.8;\n  //         geometry.vertices[i].multiplyScalar(scalar)\n  //     }\n  //     return geometry;\n  // }\n\n  function update(time) {\n    var angle = time * speed;\n    group.rotation.y = angle;\n    subjectMaterial.alphaMap.offset.y = 0.55 + time * textureOffsetSpeed;\n    subjectWireframe.material.color.setHSL(Math.sin(angle * 2), 0.5, 0.5);\n    var scale = (Math.sin(angle * 8) + 6.4) / 5;\n    subjectWireframe.scale.set(scale, scale, scale);\n  }\n\n  return {\n    update: update\n  };\n});","map":{"version":3,"sources":["/var/www/html/learning-react/react-threeJS/src/components/canvas/threejs/SceneSubject.js"],"names":["THREE","alphaTexture","OBJLoader","model","loader","loadGeo","load","object","console","log","setState","resource","xhr","loaded","total","error","scene","geo","group","Group","subjectGeometry","subjectMaterial","MeshStandardMaterial","color","transparent","side","DoubleSide","alphaTest","alphaMap","TextureLoader","magFilter","NearestFilter","wrapT","RepeatWrapping","repeat","y","subjectMesh","Mesh","subjectWireframe","LineSegments","EdgesGeometry","LineBasicMaterial","add","rotation","z","Math","PI","speed","textureOffsetSpeed","update","time","angle","offset","material","setHSL","sin","scale","set"],"mappings":"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","sourcesContent":["import * as THREE from 'three'\nimport alphaTexture from '../../../assets/textures/stripes_gradient.jpg';\n\nimport * as OBJLoader from \"three-obj-loader\";\nimport model from \"../../../assets/models/dummy.obj\";\nOBJLoader(THREE);\n    this.THREE = THREE;\n    this.loader = new this.THREE.OBJLoader();\n    this.loadGeo = () => {\n      this.loader.load(\n        // resource URL\n        model,\n        // called when resource is loaded\n        object => {\n          console.log(object);\n          this.setState({ resource: object });\n        },\n        // called when loading is in progresses\n        xhr => {\n          console.log((xhr.loaded / xhr.total) * 100 + \"% loaded\");\n        },\n        // called when loading has errors\n        error => {\n          console.log(\"An error happened\");\n        }\n      );\n    };\n\n\n\n\nexport default (scene,geo, model) => {    \n    const group = new THREE.Group();\n\n    // const subjectGeometry = deformGeometry(geo);\n    const subjectGeometry = geo;\n    const subjectMaterial = new THREE.MeshStandardMaterial({ color: \"#000\", transparent: true, side: THREE.DoubleSide, alphaTest: 0.5 });\n    subjectMaterial.alphaMap = new THREE.TextureLoader().load(alphaTexture);\n    subjectMaterial.alphaMap.magFilter = THREE.NearestFilter;\n    subjectMaterial.alphaMap.wrapT = THREE.RepeatWrapping;\n    subjectMaterial.alphaMap.repeat.y = 1;\n\n    const subjectMesh = new THREE.Mesh(subjectGeometry, subjectMaterial);\n        \n    const subjectWireframe = new THREE.LineSegments(\n        new THREE.EdgesGeometry(subjectGeometry),\n        new THREE.LineBasicMaterial()\n    );\n\n    //upload a model\n\n    group.add(subjectMesh);\n    group.add(subjectWireframe);\n    scene.add(group);\n\n    group.rotation.z = 6*Math.PI;\n\n    const speed = 0.02;\n    const textureOffsetSpeed = 0.02;\n\n    // function deformGeometry(geometry) {\n    //     for (let i=0; i<geometry.vertices.length; i+=2) {\n    //         const scalar = 1 + Math.random()*0.8;\n    //         geometry.vertices[i].multiplyScalar(scalar)\n    //     }\n\n    //     return geometry;\n    // }\n\n    function update(time) {\n        const angle = time*speed;\n\n        group.rotation.y = angle;\n\n        subjectMaterial.alphaMap.offset.y = 0.55 + time * textureOffsetSpeed;\n\n        subjectWireframe.material.color.setHSL( Math.sin(angle*2), 0.5, 0.5 );\n        \n        const scale = (Math.sin(angle*8)+6.4)/5;\n        subjectWireframe.scale.set(scale, scale, scale)\n    }\n\n    return {\n        update\n    }\n}"]},"metadata":{},"sourceType":"module"}